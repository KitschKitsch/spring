<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.java.mapper.FreeMapper">

	<!-- 게시글 전체 가져오기 -->
	<select id="selectAll" resultType="com.java.dto.MadangDto">
		SELECT * FROM (SELECT ROWNUM RNUM, A.* FROM NOTICE_BOARD A WHERE BOARD_CATEGORY = 'free'
			<if test="category == 'all'">
		      	AND BOARD_TITLE LIKE '%'||#{s_word}||'%' OR BOARD_CONTENTS LIKE '%'||#{s_word}||'%'
			</if>
			<if test="category == 'btitle'">
		      	AND BOARD_TITLE LIKE '%'||#{s_word}||'%'
			</if>
			<if test="category == 'content'">
		      	AND BOARD_CONTENTS LIKE '%'||#{s_word}||'%' 
			</if>
			<if test="category == 'writer'">
		      	AND AUTH_NICKNAME LIKE '%'||#{s_word}||'%' 
			</if>
			 ORDER BY BOARD_CREATED DESC)
			 WHERE RNUM BTWEEN #{startRow} AND #{endRow}
	</select>
	
	<!-- 게시글 전체 개수 -->
	<select id="selectListCount" resultType="int">
		SELECT COUNT(*) FROM NOTICE_BOARD WHERE BOARD_CATEGORY = 'free'
			<if test="category == 'all'">
		      	AND BOARD_TITLE LIKE '%'||#{s_word}||'%' OR BOARD_CONTENTS LIKE '%'||#{s_word}||'%'
			</if>
			<if test="category == 'btitle'">
		      	AND BOARD_TITLE LIKE '%'||#{s_word}||'%'
			</if>
			<if test="category == 'content'">
		      	AND BOARD_CONTENTS LIKE '%'||#{s_word}||'%' 
			</if>
			<if test="category == 'writer'">
		      	AND AUTH_NICKNAME LIKE '%'||#{s_word}||'%' 
			</if>
	</select>
	
	<!-- 게시글 1개 가져오기 -->
	<select id="selectOne" resultType="com.java.dto.MadangDto">
		SELECT * FROM NOTICE_BOARD WHERE BOARD_CATEGORY = 'free' AND BOARD_NO=#{bno}
	</select>
	<!-- 이전글 가져오기 -->
	<select id="selectPrevOne" resultType="com.java.dto.MadangDto">
		SELECT * FROM NOTICE_BOARD WHERE BOARD_CATEGORY = 'free' AND BOARD_NO=#{bno}-1
	</select>
	<!-- 다음글 가져오기 -->
	<select id="selectNextOne" resultType="com.java.dto.MadangDto">
		SELECT * FROM NOTICE_BOARD WHERE BOARD_CATEGORY = 'free' AND BOARD_NO=#{bno}+1
	</select>
	
	<!-- 댓글 가져오기 -->
	<select id="selectComAll" resultType="com.java.dto.CommentDto">
		SELECT * FROM NOTICE_COMMENT WHERE BOARD_NO=#{bno}
	</select>
</mapper>